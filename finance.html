<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Финансы</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body class="bg-gray-100 p-4">
  <div class="max-w-md mx-auto">
  <h1 class="text-2xl font-bold mb-4">Финансы</h1>
  <p class="text-lg mb-4">Общая сумма: <span id="total-amount">0</span> руб.</p>
  <form id="finance-form" class="mb-4">
    <input type="text" id="category" placeholder="Категория" class="border p-2 mr-2">
    <input type="number" id="amount" placeholder="Сумма" class="border p-2 mr-2">
    <button type="submit" class="bg-blue-500 text-white p-2">Добавить</button>
  </form>
  <canvas id="finance-chart"></canvas>
</div>
  <script src="app.js"></script>
</body>
</html>

<script>
    const ctx = document.getElementById('finance-chart').getContext('2d');
let expenses = JSON.parse(localStorage.getItem('expenses')) || [];

const chart = new Chart(ctx, {
  type: 'doughnut',
  data: {
    labels: [],
    datasets: [{
      data: [],
      backgroundColor: ['#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', '#9966FF'],
    }]
  },
  options: {
    responsive: true,
    plugins: { legend: { position: 'top' } }
  }
});

document.getElementById('finance-form').addEventListener('submit', (e) => {
  e.preventDefault();
  const category = document.getElementById('category').value;
  const amount = parseFloat(document.getElementById('amount').value);

  expenses.push({ category, amount });
  localStorage.setItem('expenses', JSON.stringify(expenses));
  updateChart();
  updateTotalAmount();
  e.target.reset();
});

function updateChart() {
  const categories = [...new Set(expenses.map(item => item.category))];
  const amounts = categories.map(cat => 
    expenses.filter(item => item.category === cat).reduce((sum, item) => sum + item.amount, 0)
  );

  chart.data.labels = categories;
  chart.data.datasets[0].data = amounts;
  chart.update();
}

function updateTotalAmount() {
  const total = expenses.reduce((sum, item) => sum + item.amount, 0);
  document.getElementById('total-amount').textContent = total.toFixed(2);
}

updateChart();
updateTotalAmount();
</script>